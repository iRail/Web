<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=320; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
		<title>iRail - Web</title>
		<script type="text/javascript" src="js/irail-api.js"></script>
		<script type="text/javascript" src="js/util.js"></script>
		<script type="text/javascript" src="js/app.js"></script>
		<link rel="stylesheet" type="text/css" href="css/master.css" />
	</head>
	<body>
		<div id="search">
		</div>
		<div id="results">
		</div>

		<script type="text/html" id="search_template">
		<![CDATA[
			<form id="form">
				<p>
					<label for="departure">From</label>
					<input type="text" class="text" name="departure" value="" />
				</p>
				<p>
					<label for="arrival">To</label>
					<input type="text" class="text" name="arrival" value="" />
				</p>
				<p class="radio">
					<input type="radio" class="radio" name="departure-or-arrival" value="departure" /> 
					<label for="departure-or-arrival">Depart at</label>
					<input type="radio" class="radio" name="departure-or-arrival" value="arrival" checked="checked" /> 
					<label for="departure-or-arrival">Arrive at</label>
				</p>
				<% var now = new Date(),
					day    = now.getDate(),
					month  = (now.getMonth()+1),
					year   = now.getFullYear(),
					hour   = now.getHours(),
					minute = Math.ceil(now.getMinutes()/5)*5;
				%>
				<p>
					<select name="day">
					<% for (var i=1; i<=31; i++) { %>
						<option<%= (day==i ? ' selected="selected"' : '') %>><%= i %></option>
					<% } %>
					</select>
					 / 
					<select name="month">
					<% for (var i=1; i<=12; i++) { %>
						<option<%= (month==i ? ' selected="selected"' : '') %>><%= i %></option>
					<% } %>
					</select>
					 / 
					<select name="year">
					<% for (var i=year; i<=year+1; i++) { %>
						<option<%= (year==i ? ' selected="selected"' : '') %>><%= i %></option>
					<% } %>
					</select>
				</p>
				<p>
					<select name="hour">
					<% for (var i=0; i<=23; i++) { %>
						<option<%= (hour==i ? ' selected="selected"' : '') %>><%= i %></option>
					<% } %>
					</select>
					 : 
					<select name="minute">
					<% for (var i=0; i<=59; i+=5) { %>
						<option<%= (minute==i ? ' selected="selected"' : '') %>><%= i %></option>
					<% } %>
					</select>
				</p>
				<p>
					<input type="submit" class="submit" value="Search">
				</p>
			</form>
		]]>
		</script>
		
		<script type="text/html" id="results_template">
		<![CDATA[
			<!-- Tables? I hear you ask. You are welcome to fix it. -->
			<% for (var i=0; i<connection.length; i++) { %>
			<table cellspacing="0" class="results">
				<tbody>
					<tr>
						<td>
							<span class="departure"><%= _.t(connection[i].departure.time, 'hh:mm') %></span>
							<span class="arrival"><%= _.t(connection[i].arrival.time, 'hh:mm') %></span>
							<span class="duration"><%= _.t(connection[i].duration, 'hh:mm') %></span>
						</td>
					</tr>
					<tr class="departure">
						<td><%= _.h(connection[i].departure.station) %></td>
					</tr>
					<% for (var j=0; j<connection[i].vias.via.length; j++) { %>
					<tr class="via">
						<td><%= _.h(connection[i].vias.via[j].station) %></td>
					</tr>
					<% } %>
					<tr class="arrival">
						<td><%= _.h(connection[i].arrival.station) %></td>
					</tr>
				</tbody>
			</table>
			<% } %>
		]]>
		</script>
	</body>
</html>